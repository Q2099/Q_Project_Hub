document.addEventListener("DOMContentLoaded", function() {
  function updateSummary() {
    const airline = document.getElementById("cc_sb3_sb3_flighthotel_sb3_flight_airlines_0");
    const classOfService = document.getElementById("cc_sb3_sb3_flighthotel_sb3_flight_classofservice");
    const numRooms = document.getElementById("cc_sb3_sb3_flighthotel_sb3_flighthotel_numRooms");
    const numGuests1 = document.getElementById("cc_sb3_sb3_flighthotel_flighthotel_numGuests1");
    const numGuests2 = document.getElementById("cc_sb3_sb3_flighthotel_flighthotel_numGuests2");
    const numGuests3 = document.getElementById("cc_sb3_sb3_flighthotel_flighthotel_numGuests3");
    const summaryBox = document.getElementById("summary");

    if (!summaryBox) return;

    const starRatings = document.querySelectorAll("#cc_sb3_sb3_flighthotel_start_rating_ctr_copy input[type='checkbox']:checked");
    const boardBasis = document.querySelectorAll("#cc_sb3_sb3_flighthotel_boardBasis_ctr input[type='checkbox']:checked");
    const directFlights = document.getElementById("cc_sb3_sb3_flighthotel_sb3_flighthotel_directflights_copy");
    const bagOnlyFares = document.getElementById("cc_sb3_sb3_flighthotel_bagOnly_fares");

    const air = airline?.value || "Any Airline";

    const classMap = { E: "Economy", P: "Premium Economy", B: "Business", F: "First" };
    const travelClass = classMap[classOfService?.value] || "Any";

    const rooms = numRooms?.value || "1";
    const g1 = numGuests1?.value || "0";
    const g2 = numGuests2?.value || "0";
    const g3 = numGuests3?.value || "0";

    let guestsText = `${g1} in Room 1`;
    if (rooms >= 2) guestsText += `, ${g2} in Room 2`;
    if (rooms == 3) guestsText += `, ${g3} in Room 3`;

    const starValues = Array.from(starRatings).map(cb => cb.value);
    const starText = starValues.length > 0 ? `★ Star Rating: ${starValues.join(", ")}` : "";

    const boardValues = Array.from(boardBasis).map(cb => cb.value);
    let boardText = "";
    if (boardValues.length > 0 && boardValues.length < 3) {
      boardText = `Board: ${boardValues.join(", ")}`;
    } else if (boardValues.length >= 3 && boardValues.length < 6) {
      boardText = `Board: Multiple`;
    } else if (boardValues.length === 6) {
      boardText = `Board: All`;
    }

    const directText = directFlights?.checked ? "Direct Flights Only" : "";
    const bagText = bagOnlyFares?.checked ? "Hand Luggage Only" : "";

    const summaryParts = [
      `${air} | Class: ${travelClass}`,
      `🏨 Rooms: ${rooms} (${guestsText})`,
      starText,
      boardText,
      directText,
      bagText
    ].filter(Boolean);

    summaryBox.textContent = summaryParts.join("\n");
  }

  function initSummaryListeners() {
    const fields = document.querySelectorAll("input, select");
    fields.forEach(field => {
      field.addEventListener("change", updateSummary);
      field.addEventListener("input", updateSummary);
    });
    updateSummary(); // initial run
  }

  initSummaryListeners();
});

